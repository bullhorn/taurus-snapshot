!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("axios")):"function"==typeof define&&define.amd?define(["exports","rxjs","axios"],e):e(t.taurus={},t.rxjs,t.axios)}(this,function(t,e,r){"use strict";var n;r=r&&r.hasOwnProperty("default")?r.default:r,(n=t.FieldType||(t.FieldType={}))[n.ID=0]="ID",n[n.COMPOSITE=1]="COMPOSITE",n[n.TO_ONE=2]="TO_ONE",n[n.TO_MANY=3]="TO_MANY",n[n.SCALAR=4]="SCALAR";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function u(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function u(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,u)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var a,h={e:{}};function l(){try{return a.apply(this,arguments)}catch(t){return h.e=t,h}}function f(t){return a=t,l}function p(t){return"function"==typeof t}var d=!1,b={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;d=t},get useDeprecatedSynchronousErrorHandling(){return d}};function y(t){setTimeout(function(){throw t})}var v={closed:!0,next:function(t){},error:function(t){if(b.useDeprecatedSynchronousErrorHandling)throw t;y(t)},complete:function(){}},m=Array.isArray||function(t){return t&&"number"==typeof t.length};function g(t){return null!=t&&"object"==typeof t}function _(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}_.prototype=Object.create(Error.prototype);var w=_,S=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,n=this._parents,i=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,u=n?n.length:0;r;)r.remove(this),r=++s<u&&n[s]||null;if(p(i))f(i).call(this)===h&&(e=!0,t=t||(h.e instanceof w?O(h.e.errors):[h.e]));if(m(o))for(s=-1,u=o.length;++s<u;){var c=o[s];if(g(c))if(f(c.unsubscribe).call(c)===h){e=!0,t=t||[];var a=h.e;a instanceof w?t=t.concat(O(a.errors)):t.push(a)}}if(e)throw new w(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();function O(t){return t.reduce(function(t,e){return t.concat(e instanceof w?e.errors:e)},[])}var E="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),x=function(t){function e(r,n,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,o._parentSubscription=null,arguments.length){case 0:o.destination=v;break;case 1:if(!r){o.destination=v;break}if("object"==typeof r){r instanceof e?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new j(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new j(o,r,n,i)}return o}return o(e,t),e.prototype[E]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},e}(S),j=function(t){function e(e,r,n,i){var o,s=t.call(this)||this;s._parentSubscriber=e;var u=s;return p(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==v&&(p((u=Object.create(r)).unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(s))),s._context=u,s._next=o,s._error=n,s._complete=i,s}return o(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;b.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=b.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):y(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;y(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};b.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),b.useDeprecatedSynchronousErrorHandling)throw t;y(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!b.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return b.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(y(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(x),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(x),P=function(t){function e(e,r,n){var i=t.call(this)||this;return i.parent=e,i.outerValue=r,i.outerIndex=n,i.index=0,i}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(x);var T="function"==typeof Symbol&&Symbol.observable||"@@observable";function A(){}var I=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=function(t,e,r){if(t){if(t instanceof x)return t;if(t[E])return t[E]()}return t||e||r?new x(t,e,r):new x(v)}(t,e,r);if(n?n.call(i,this.source):i.add(this.source||b.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),b.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){b.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,i=e.isStopped;if(r||i)return!1;t=n&&n instanceof x?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=C(e))(function(e,n){var i;i=r.subscribe(function(e){try{t(e)}catch(t){n(t),i&&i.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[T]=function(){return this},t.prototype.pipe=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:A)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=C(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function C(t){if(t||(t=b.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var D=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.closed||e.complete()}},N=function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,y),e}};var R=function(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}(),L=function(t){return function(e){for(var r=t[R]();;){var n=r.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add(function(){r.return&&r.return()}),e}},M=function(t){return function(e){var r=t[T]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(e)}},z=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function U(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var V=function(t){if(t instanceof I)return function(e){return t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e)};if(t&&"function"==typeof t[T])return M(t);if(z(t))return D(t);if(U(t))return N(t);if(t&&"function"==typeof t[R])return L(t);var e=g(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function B(t,e,r,n,i){if(void 0===i&&(i=new P(t,r,n)),!i.closed)return V(e)(i)}var F=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new $(t,this.durationSelector))},t}(),$=function(t){function e(e,r){var n=t.call(this,e)||this;return n.durationSelector=r,n.hasValue=!1,n}return o(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=f(this.durationSelector)(t);if(e===h)this.destination.error(h.e);else{var r=B(this,e);!r||r.closed?this.clearThrottle():this.add(this.throttled=r)}}},e.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,r=this.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},e.prototype.notifyNext=function(t,e,r,n){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(k),H=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return o(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,r){return t.call(this)||this}return o(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(S)),Y=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=function(){return Date.now()},t}(),Q=function(t){function e(r,n){void 0===n&&(n=Y.now);var i=t.call(this,r,function(){return e.delegate&&e.delegate!==i?e.delegate.now():n()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return o(e,t),e.prototype.schedule=function(r,n,i){return void 0===n&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(r,n,i):t.prototype.schedule.call(this,r,n,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(Y),q=new Q(H);function J(t){return!m(t)&&t-parseFloat(t)+1>=0}function W(t){return t&&"function"==typeof t.schedule}function K(t){var e=t.index,r=t.period,n=t.subscriber;if(n.next(e),!n.closed){if(-1===r)return n.complete();t.index=e+1,this.schedule(t,r)}}function G(t,e){return void 0===e&&(e=q),r=function(){return function(t,e,r){void 0===t&&(t=0);var n=-1;return J(e)?n=Number(e)<1?1:Number(e):W(e)&&(r=e),W(r)||(r=q),new I(function(e){var i=J(t)?t:+t-r.now();return r.schedule(K,i,{index:0,period:n,subscriber:e})})}(t,e)},function(t){return t.lift(new F(r))};var r}function X(t,e){return new I(e?function(r){var n=new S,i=0;return n.add(e.schedule(function(){i!==t.length?(r.next(t[i++]),r.closed||n.add(this.schedule())):r.complete()})),n}:D(t))}function Z(t,e){if(!e)return t instanceof I?t:new I(V(t));if(null!=t){if(function(t){return t&&"function"==typeof t[T]}(t))return function(t,e){return new I(e?function(r){var n=new S;return n.add(e.schedule(function(){var i=t[T]();n.add(i.subscribe({next:function(t){n.add(e.schedule(function(){return r.next(t)}))},error:function(t){n.add(e.schedule(function(){return r.error(t)}))},complete:function(){n.add(e.schedule(function(){return r.complete()}))}}))})),n}:M(t))}(t,e);if(U(t))return function(t,e){return new I(e?function(r){var n=new S;return n.add(e.schedule(function(){return t.then(function(t){n.add(e.schedule(function(){r.next(t),n.add(e.schedule(function(){return r.complete()}))}))},function(t){n.add(e.schedule(function(){return r.error(t)}))})})),n}:N(t))}(t,e);if(z(t))return X(t,e);if(function(t){return t&&"function"==typeof t[R]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new I(e?function(r){var n,i=new S;return i.add(function(){n&&"function"==typeof n.return&&n.return()}),i.add(e.schedule(function(){n=t[R](),i.add(e.schedule(function(){if(!r.closed){var t,e;try{var i=n.next();t=i.value,e=i.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}}))})),i}:L(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}var tt=new I(function(t){return t.complete()});function et(t){return t?function(t){return new I(function(e){return t.schedule(function(){return e.complete()})})}(t):tt}var rt=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new nt(t,this.project,this.thisArg))},t}(),nt=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.project=r,i.count=0,i.thisArg=n||i,i}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(x);function it(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(it(function(r,n){return Z(t(r,n)).pipe(function(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new rt(t,e))}}(function(t,i){return e(r,t,n,i)}))},r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new ot(t,r))})}var ot=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new st(t,this.project,this.concurrent))},t}(),st=function(t){function e(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=r,i.concurrent=n,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return o(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},e.prototype._innerSub=function(t,e,r){var n=new P(this,void 0,void 0);this.destination.add(n),B(this,t,e,r,n)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(k);function ut(t){return t}function ct(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}ct.prototype=Object.create(Error.prototype);var at=ct;var ht=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new lt(t,this.predicate,this.thisArg))},t}(),lt=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.predicate=r,i.thisArg=n,i.count=0,i}return o(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(x);function ft(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}ft.prototype=Object.create(Error.prototype);var pt=function(){function t(t){if(this.total=t,this.total<0)throw new at}return t.prototype.call=function(t,e){return e.subscribe(new dt(t,this.total))},t}(),dt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return o(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(x);function bt(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}bt.prototype=Object.create(Error.prototype);var yt=bt,vt=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return o(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(S),mt=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return o(e,t),e}(x),gt=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o(e,t),e.prototype[E]=function(){return new mt(this)},e.prototype.lift=function(t){var e=new _t(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new yt;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new yt;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new yt;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new yt;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new yt;return this.hasError?(t.error(this.thrownError),S.EMPTY):this.isStopped?(t.complete(),S.EMPTY):(this.observers.push(t),new vt(this,t))},e.prototype.asObservable=function(){var t=new I;return t.source=this,t},e.create=function(t,e){return new _t(t,e)},e}(I),_t=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return o(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):S.EMPTY},e}(gt);function wt(){return function(t){return t.lift(new St(t))}}var St=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var n=new Ot(t,r),i=e.subscribe(n);return n.closed||(n.connection=r.connect()),i},t}(),Ot=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return o(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,n=t._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null},e}(x),Et=function(t){function e(e,r){var n=t.call(this)||this;return n.source=e,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return o(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new S).add(this.source.subscribe(new jt(this.getSubject(),this))),t.closed?(this._connection=null,t=S.EMPTY):this._connection=t),t},e.prototype.refCount=function(){return wt()(this)},e}(I).prototype,xt={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:Et._subscribe},_isComplete:{value:Et._isComplete,writable:!0},getSubject:{value:Et.getSubject},connect:{value:Et.connect},refCount:{value:Et.refCount}},jt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return o(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(mt);var kt=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var r=this.selector,n=this.subjectFactory(),i=r(n).subscribe(t);return i.add(e.subscribe(n)),i},t}();function Pt(){return new gt}function Tt(){return function(t){return wt()((e=Pt,function(t){var n;if(n="function"==typeof e?e:function(){return e},"function"==typeof r)return t.lift(new kt(n,r));var i=Object.create(t,xt);return i.source=t,i.subjectFactory=n,i})(t));var e,r}}var At=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.complete=function(){},e.prototype.error=function(t){this.error=t,this.observers.forEach(function(e){e.error(t),e.closed=!1})},e}(e.ReplaySubject),It=function(){function t(){if(this.subjects=[],this.messageBus=new At,this.messageStream=this.messageBus.pipe(Tt()),t._instance)throw new Error("Error: Instantiation failed: Use EntityMessageBroker.getInstance() instead of new.");t._instance=this}return t.getInstance=function(){return t._instance},t.prototype.emit=function(t,e){void 0===e&&(e={});var r=this.subject(t);return r.next(e),r},t.prototype.subject=function(t){var r=function(t,e){var r=t.filter(function(t){return t.name===e});if(r&&!(r.length<1))return r[0]}(this.subjects,t);return r||((r=new e.Subject).name=t,this.subjects.push(r),this.messageBus.next(r)),r},t.prototype.on=function(t){return-1===t.indexOf("#")&&-1===t.indexOf("*")?this.subject(t):this.messageStream.pipe((r=function(e){return function(t,e){if(-1===e.indexOf("#")&&-1===e.indexOf("*"))return t===e;var r=function(t){return"^"+t.split(".").reduce(function(t,e,r,n){var i="";return n[r-1]&&(i="#"!==n[r-1]?"\\.\\b":"\\b"),t+(i+="#"===e?"[\\s\\S]*":"*"===e?"[^.]+":e)},"")}(e);return new RegExp(r).test(t)}(e.name,t)},function(t){return t.lift(new ht(r,n))}),(void 0===e&&(e=Number.POSITIVE_INFINITY),it(ut,e)));var e,r,n},t._instance=new t,t}(),Ct=function(){function t(t){this.obj=t}return t.prototype.have=function(t){for(var e=t.split("."),r=this.obj,n=0,i=e;n<i.length;n++){if(r=r[i[n]],!1===this.check(r))return r}return r},t.prototype.check=function(t){return void 0!==t},t}();function Dt(t){return new Ct(t)}var Nt=function(){function t(t){this.reference={},this.reference=t}return Object.defineProperty(t.prototype,"aBoolean",{get:function(){return this.a(Boolean)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aDate",{get:function(){return this.a(Date)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aFunction",{get:function(){return this.a(Function)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anArray",{get:function(){return this.a(Array)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anError",{get:function(){return this.a(Error)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anObject",{get:function(){return this.a(Object)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aNonEmptyArray",{get:function(){return this.anArray&&!!this.reference.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aNonEmptyString",{get:function(){return this.aString&&!!this.reference.trim()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aNumber",{get:function(){return this.a(Number)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aRegExp",{get:function(){return this.a(RegExp)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aString",{get:function(){return this.a(String)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defined",{get:function(){return!this.undefined&&!this.null&&!this.nan},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nan",{get:function(){return this.a(NaN)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"null",{get:function(){return this.a(null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"undefined",{get:function(){return this.a(void 0)},enumerable:!0,configurable:!0}),t.prototype.a=function(t){var e=!1,r=this.reference.constructor.name;switch(t){case void 0:e="Undefined"===r;break;case null:e="Null"===r;break;case Array:e="Array"===r;break;case Boolean:e="Boolean"===r;break;case Date:e="Date"===r;break;case Error:e="Error"===r;break;case Function:e="Function"===r;break;case Number:e="Number"===r&&!isNaN(this.reference);break;case RegExp:e="RegExp"===r;break;case String:e="String"===r;break;case Object:e="Object"===r||"Arguments"===r;break;default:e="Number"===t.constructor.name&&isNaN(t)?"Number"===r&&isNaN(this.reference):this.reference instanceof t}return e},t.prototype.aTypeOf=function(t){var e=!1;if("function"==typeof t&&!(e=t===this.reference)&&!(e=t.isPrototypeOf(this.reference)))for(var r=this.reference;"function"==typeof r&&!(e=r===t)&&r!==Object;)r="object"==typeof r.prototype&&Object.getPrototypeOf(r).constructor===Function?(Object.getPrototypeOf(r.prototype)||{}).constructor:Object.getPrototypeOf(r);return e},t}();function Rt(t){return new Nt(t)}var Lt=function(){function t(){this.dataStore={}}return t.prototype.setItem=function(t,e){this.dataStore[t]=e||""},t.prototype.getItem=function(t){return this.dataStore[t]},t.prototype.removeItem=function(t){delete this.dataStore[t]},t.prototype.clear=function(){this.dataStore={}},Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.dataStore).length},enumerable:!0,configurable:!0}),t.prototype.key=function(t){return Object.keys(this.dataStore)[t]||null},t}(),Mt=function(){function t(){this.storageSize=5242880;var t=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,e="undefined"!=typeof InstallTrigger,r=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),n=!!document.documentMode,i=!n&&!!window.StyleMedia,o=!(!window.chrome||!window.chrome.webstore&&!window.chrome.runtime);(o||t)&&window.CSS;t?this.name="opera":r?this.name="safari":n?this.name="IE":i?this.name="edge":o?this.name="chrome":e&&(this.name="firefox"),(o||e)&&(this.storageSize=10485760)}return t.prototype.getStorageSize=function(){return this.storageSize},t}();const zt=(t,e)=>e.some(e=>t instanceof e);let Ut,Vt;const Bt=new WeakMap,Ft=new WeakMap,$t=new WeakMap,Ht=new WeakMap,Yt=new WeakMap;let Qt={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return Ft.get(t);if("objectStoreNames"===e)return t.objectStoreNames||$t.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Wt(t[e])},has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function qt(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Vt||(Vt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Kt(this),e),Wt(Bt.get(this))}:function(...e){return Wt(t.apply(Kt(this),e))}:function(e,...r){const n=t.call(Kt(this),e,...r);return $t.set(n,e.sort?e.sort():[e]),Wt(n)}}function Jt(t){return"function"==typeof t?qt(t):(t instanceof IDBTransaction&&function(t){if(Ft.has(t))return;const e=new Promise((e,r)=>{const n=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),n()},o=()=>{r(t.error),n()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Ft.set(t,e)}(t),zt(t,Ut||(Ut=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Qt):t)}function Wt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,r)=>{const n=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(Wt(t.result)),n()},o=()=>{r(t.error),n()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(e=>{e instanceof IDBCursor&&Bt.set(e,t)}),Yt.set(e,t),e}(t);if(Ht.has(t))return Ht.get(t);const e=Jt(t);return e!==t&&(Ht.set(t,e),Yt.set(e,t)),e}const Kt=t=>Yt.get(t);const Gt=["get","getKey","getAll","getAllKeys","count"],Xt=["put","add","delete","clear"],Zt=new Map;function te(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Zt.get(e))return Zt.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Xt.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!Gt.includes(r))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let s=o.store;n&&(s=s.index(e.shift()));const u=s[r](...e);return i&&await o.done,u};return Zt.set(e,o),o}Qt=(t=>({get:(e,r,n)=>te(e,r)||t.get(e,r,n),has:(e,r)=>!!te(e,r)||t.has(e,r)}))(Qt);var ee,re=new Lt,ne=new Mt;try{if("indexedDB"in window)try{ee=function(t,e,{blocked:r,upgrade:n,blocking:i}={}){const o=indexedDB.open(t,e),s=Wt(o);return n&&o.addEventListener("upgradeneeded",t=>{n(Wt(o.result),t.oldVersion,t.newVersion,Wt(o.transaction))}),r&&o.addEventListener("blocked",()=>r()),i&&s.then(t=>t.addEventListener("versionchange",i)),s}("keyval-store",1,{upgrade:function(t){t.createObjectStore("keyval")}})}catch(t){ee=void 0,console.warn("Could not set up indexed DB",t.message)}window.localStorage&&(re=window.localStorage)}catch(t){console.warn("Unable to setup localstorage cache.",t.message)}var ie=function(){function t(){}return Object.defineProperty(t,"storage",{set:function(t){re=t},enumerable:!0,configurable:!0}),t.list=function(){return u(this,void 0,void 0,function(){var e,r,n=this;return c(this,function(i){switch(i.label){case 0:return void 0===ee?[3,3]:[4,ee];case 1:return[4,i.sent().getAllKeys("keyval")];case 2:return i.sent().forEach(function(e){return u(n,void 0,void 0,function(){var r,n,i,o,s;return c(this,function(u){switch(u.label){case 0:return console&&e?(n=(r=console).debug,i=e.toString()+" --\x3e ",s=(o=JSON).stringify,[4,t.get(e.toString())]):[3,2];case 1:n.apply(r,[i+s.apply(o,[u.sent()])]),u.label=2;case 2:return[2]}})})}),[2];case 3:for(e=0;e<re.length;e++)r=re.key(e),console&&r&&console.debug(re.key(e)+" --\x3e "+re.getItem(r));return[2]}})})},t.exceedsStorageLimit=function(e,r){var n=ne.getStorageSize();return t.getLocalStorageSize()+2*((e?e.length:0)+(r?r.length:0))>=n},t.getLocalStorageSize=function(){for(var t=0,e=0,r=Object.keys(re);e<r.length;e++){var n=r[e];if(re.hasOwnProperty(n))t+=2*(localStorage[n].length+n.length)}return t},t.put=function(e,r){return u(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return void 0===ee?[3,2]:[4,ee];case 1:return n.sent().put("keyval",r,e),[2,Promise.resolve(r)];case 2:if(!t.exceedsStorageLimit(e,r)){null!==r&&"object"==typeof r&&(r.dateCached=(new Date).getTime());try{re.setItem(e,JSON.stringify(r))}catch(t){console.error(t)}}return[2,Promise.resolve(r)]}})})},t.get=function(e){return u(this,void 0,void 0,function(){var r;return c(this,function(n){switch(n.label){case 0:return void 0===ee?[3,2]:[4,ee];case 1:return[2,n.sent().get("keyval",e)];case 2:return(r=re.getItem(e))?(t.handleStorageRankingUpdate(e),[2,Promise.resolve(JSON.parse(r))]):[2,null]}})})},t.has=function(e){return u(this,void 0,void 0,function(){var r,n,i;return c(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.get(e)];case 1:return r=o.sent(),n=Date.now()-864e5,void 0!==r&&r&&""!==r?r.dateCached?[2,r.dateCached>n]:[2,Promise.resolve(!0)]:[2,Promise.resolve(!1)];case 2:return i=o.sent(),console.warn("An error occurred while looking for "+e+" in Cache",i),[2,Promise.resolve(!1)];case 3:return[2]}})})},t.remove=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return void 0===ee?[3,2]:[4,ee];case 1:return e.sent().delete("keyval",t),[2];case 2:return re.removeItem(t),[2]}})})},t.clear=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return void 0===ee?[3,2]:[4,ee];case 1:return t.sent().clear("keyval"),[2];case 2:return re.clear(),[2]}})})},t.getStorageRankings=function(){var t=re.getItem("storageRankings");return t?JSON.parse(t):{}},t.handleStorageRankingUpdate=function(e){var r=t.getStorageRankings();r[e]=r[e]?parseInt(r[e],10)+1:1,t.put("storageRankings",r)},t}();var oe=function(){function t(){}return t.from=function(t){var e,r,n=new Promise(function(t,n){e=t,r=n});return n.__then=n.then,n.then=function(n,i){setImmediate(function(){t(e,r)}),this.__then(n,i)},n},t.series=function(t,e){return void 0===e&&(e=1),u(this,void 0,void 0,function(){var r,n;return c(this,function(i){return n=t.slice(),[2,new Promise(function(t,i){var o=function(s){if(r=r?r.concat(s):[],!n.length)return t(r);var u=n.splice(0,e);Promise.all(u).then(o).catch(i)};o()})]})})},t}(),se=function(){function t(e,r){void 0===r&&(r={}),this.parts=[],this.url=e,this.parts=t.encodeParams(r)}return t.destruct=function(t){var e=t.protocol+"//"+t.host+t.pathname,r={};return t.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(t,e,n,i){r[decodeURIComponent(e)]=decodeURIComponent(i)}),{url:e,params:r}},t.encodeParams=function(t){var e=[];if(t)for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r],o=t[i];Array.isArray(o)?e.push(i+"="+encodeURIComponent(o.join(","))):e.push(i+"="+encodeURIComponent(o))}return e},t.stringify=function(e){return t.encodeParams(e).join("&")},t.prototype.toString=function(){return this.url+(-1===this.url.indexOf("?")?"?":"&")+this.parts.join("&")},t}(),ue=function(){function t(t){void 0===t&&(t={}),this.options=t,this.useCookies=!1,this.config={client_id:"UNDEFINED",client_secret:"UNDEFINED",authorization_url:"https://auth.bullhornstaffing.com/oauth/authorize",token_url:"https://auth.bullhornstaffing.com/oauth/token",login_url:"https://rest.bullhornstaffing.com/rest-services/login",redirect_url:"https://localhost:3000",apiVersion:"*",useCookies:!1},this.config=s({},this.config,this.options),this.useCookies=t.useCookies||!1,this.options.BhRestToken?ie.put("BhRestToken",this.config.BhRestToken):this.useCookies=!0,this.options.restUrl&&ie.put("restUrl",this.config.restUrl)}return t.prototype.login=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,t.credential(this.config).then(function(t){return ie.put("BhRestToken",t.BhRestToken),ie.put("restUrl",t.restUrl),t})]})})},t.prototype.isLoggedIn=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return[2,this.ping()]})})},t.http=function(){return u(this,void 0,void 0,function(){var e,r,n,i,o;return c(this,function(s){switch(s.label){case 0:return(e=function(t){if("undefined"!=typeof document)for(var e=t+"=",r=0,n=document.cookie.split(";");r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return!1}("UlEncodedIdentity"))&&e.length?(r=JSON.parse(decodeURIComponent(e)),n=r.sessions.reduce(function(t,e){return t[e.name]=e.value.endpoint,t},{}),t._http.defaults.baseURL=n.rest,t._http.defaults.withCredentials=!0,[2,t.makeCall()]):[4,ie.get("BhRestToken")];case 1:return i=s.sent(),[4,ie.get("restUrl")];case 2:return o=s.sent(),i&&o&&(t._http.defaults.baseURL=o,t._http.defaults.params={BhRestToken:i},t._http.defaults.withCredentials=!1),[2,t.makeCall()]}})})},t.makeCall=function(){var e=this;return t.httpInitialized||(t.httpInitialized=!0,t._http.interceptors.response.use(function(e){var r=e.config._timing||void 0;return t.trackingCallback&&r&&t.trackingCallback(r.url,(new Date).getTime()-r.start),e},function(r){return u(e,void 0,void 0,function(){var e,n;return c(this,function(i){return e=r.response,n=e.config._timing||{},t.trackingCallback&&n&&t.trackingCallback(n.url,(new Date).getTime()-n.start),401===r.response.status&&t.unauthorized.next(r),[2,Promise.reject(r)]})})}),t._http.interceptors.request.use(function(t){return t._timing={start:(new Date).getTime(),url:(t.url||"").replace(t.baseURL||"","").split("?")[0]},t})),t._http},t.prototype.ping=function(){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,t.http()];case 1:return[2,e.sent().get("ping")]}})})},t.unauthorized=new e.Subject,t._http=r.create({paramsSerializer:function(t){return se.stringify(t)}}),t.httpInitialized=!1,t}(),ce=function(){function t(t){this.entity=t,this.memory={},this.fields=[],this.layouts=[],this.tracks=[],this.sectionHeaders=[],this.allFieldsLoaded=!1,this.parameters={fields:"*",meta:"full"},this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t,e;return c(this,function(r){switch(r.label){case 0:return t=this,[4,ue.http()];case 1:return t.http=r.sent(),[4,ie.get(this.endpoint)];case 2:return(e=r.sent())?this.parse(e):this.parse({fields:[],layouts:[]}),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return"meta/"+this.entity},enumerable:!0,configurable:!0}),t.prototype.setFieldsOnLayout=function(t,e){if(t&&t.layouts){var r=t.layouts.findIndex(function(t){return t.name===e});return r>-1&&(t.layouts[r].fields=t.fields.map(function(t){return t.name})),r}return-1},t.prototype.style=function(t){return void 0===t&&(t="full"),this.parameters.meta=t,this},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(t,e){return u(this,void 0,void 0,function(){var r,n,i;return c(this,function(o){switch(o.label){case 0:return[4,this.initialized];case 1:return o.sent(),(r=this.missing(t)).length||e?(this.parameters.fields=r.join(","),e&&(this.parameters.layout=e),console.log("Making meta call for these fields",t.toString(),this.endpoint),[4,this.http.get(this.endpoint,{params:this.parameters})]):[3,3];case 2:return n=o.sent(),i=n.data,this.allFieldsLoaded="*"===t[0],this.parse(i),this.label=i.label,[2,this.extract(t)];case 3:return[2,this.extract(t)]}})})},t.prototype.getTracks=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this.memory?[3,3]:[4,this.get(["*"])];case 2:return t.sent(),[2,this.tracks];case 3:return[2,this.tracks]}})})},t.prototype.getFields=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this.memory?[3,3]:[4,this.get(["*"])];case 2:return t.sent(),[2,this.fields];case 3:return[2,this.fields]}})})},t.prototype.getAllLayouts=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),this.allFieldsLoaded?[2,this.layouts]:[4,this.http.get(this.endpoint,{params:{meta:"full",includeLayoutFields:!0}})];case 2:return t=e.sent(),this.parse(t.data),[2,t.data.layouts]}})})},t.prototype.getFull=function(t,e){return u(this,void 0,void 0,function(){var r,n,i,o;return c(this,function(s){switch(s.label){case 0:return[4,this.initialized];case 1:return s.sent(),[4,this.get(t)];case 2:return r=s.sent(),e?[4,this.getByLayout(e)]:[3,4];case 3:return i=s.sent(),[3,5];case 4:i=[],s.label=5;case 5:return n=i,[4,ie.get(this.endpoint)];case 6:return(o=s.sent()).fields=r.concat(n),[2,o]}})})},t.prototype.getByLayout=function(t,e){return void 0===e&&(e=!0),u(this,void 0,void 0,function(){var r,n,i,o;return c(this,function(s){switch(s.label){case 0:return[4,this.initialized];case 1:return s.sent(),(r=this.layouts.find(function(e){return e.name===t}))&&r.hasOwnProperty("fields")?[3,3]:(this.parameters.layout=t,delete this.parameters.fields,[4,this.http.get(this.endpoint,{params:this.parameters})]);case 2:return n=s.sent(),i=n.data,o=this.setFieldsOnLayout(i,t),this.label=i.label,this.parse(i,e),o>-1?this.layouts.splice(o,1,{name:t,label:t,enabled:!0,fields:i.layouts[o].fields}):this.layouts.push({name:t,label:t,enabled:!0,fields:i.fields.map(function(t){return t.name})}),[2,Promise.resolve(i.fields)];case 3:return[2,this.get(r.fields)]}})})},t.prototype.parse=function(t,e){if(void 0===e&&(e=!1),t){if(t&&t.fields){for(var r=function(t){n.memory.hasOwnProperty(t.name)||Object.defineProperty(n,t.name,{get:function(){return this.memory[t.name]},set:function(e){this.memory[t.name]=e},configurable:!0,enumerable:!0}),n.fields.find(function(e){return e.name===t.name})||n.fields.push(t),n.memory[t.name]=t},n=this,i=0,o=t.fields;i<o.length;i++){r(o[i])}this.fields.sort(function(t,e){var r=t.sortOrder?t.sortOrder:t.name,n=e.sortOrder?e.sortOrder:e.name;return r>n?1:n>r?-1:0})}if(t&&t.layouts)for(var s=function(t){var e=u.layouts.find(function(e){return e.name===t.name});e?t.fields&&(e.fields=t.fields):u.layouts.push(t)},u=this,c=0,a=t.layouts;c<a.length;c++){s(a[c])}t&&t.trackTrigger&&(this.trackTrigger=t.trackTrigger,this.tracks=t.tracks),t&&t.sectionHeaders&&(this.sectionHeaders=t.sectionHeaders),t.fields=e?t.fields:this.fields,t.layouts=this.layouts,t.trackTrigger=this.trackTrigger,t.tracks=this.tracks,t.sectionHeaders=this.sectionHeaders,t.allFieldsLoaded=t.allFieldsLoaded||this.allFieldsLoaded,this.allFieldsLoaded=t.allFieldsLoaded,ie.put(this.endpoint,t)}},t.prototype.missing=function(t){if(!this.memory)return t;if(t&&"*"===t[0]&&this.allFieldsLoaded)return[];for(var e=[],r=0,n=t;r<n.length;r++){var i=n[r],o=this._clean(i);this.memory[o]||e.push(o)}return e},t.prototype._clean=function(t){return t.split(".")[0].split("[")[0].split("(")[0]},t.prototype.extract=function(t){if(!this.memory)return[];if(t&&"*"===t[0])return Object.values(this.memory);for(var e=[],r=0,n=t;r<n.length;r++){var i=n[r],o=this._clean(i),s=this.memory[o];s&&"id"===s.name?e.unshift(s):e.push(s)}return e},t.validate=function(){return u(this,void 0,void 0,function(){var t,e,r,n,i,o;return c(this,function(s){switch(s.label){case 0:return[4,ue.http()];case 1:return[4,s.sent().get("/meta")];case 2:if(t=s.sent(),!(e=t.data))return[3,7];r=0,n=e,s.label=3;case 3:return r<n.length?(i=n[r]).dateLastModified?[4,ie.get("meta/"+i.entity)]:[3,5]:[3,7];case 4:return(o=s.sent())&&o.dateLastModified!==i.dateLastModified&&ie.remove("meta/"+i.entity),[3,6];case 5:ie.remove("meta/"+i.entity),s.label=6;case 6:return r++,[3,3];case 7:return[2,!0]}})})},t.preload=function(e){return u(this,void 0,void 0,function(){var r;return c(this,function(n){return r=new t(e),[2,Promise.all([r.get(["*"]),r.getAllLayouts()])]})})},t.BASIC="basic",t.FULL="full",t.TRACK="track",t}(),ae=function(){function t(t){this._fields=[],this.type=t,this.endpoint="entity/"+this.type,this.meta=new ce(this.type),this.parameters={fields:this._fields||["id"]},this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return t=this,[4,ue.http()];case 1:return t.http=e.sent(),[2]}})})},t.prototype.fields=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=Array.isArray(t[0])?t[0]:t;r<n.length;r++){var i=n[r];this._fields.includes(i)||this._fields.push(i)}return this.parameters||(this.parameters={}),this.parameters.fields=this._fields,this},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(t){return u(this,void 0,void 0,function(){var e,r,n,i;return c(this,function(o){switch(o.label){case 0:return[4,this.initialized];case 1:return o.sent(),[4,Promise.all([this.http.get(this.endpoint+"/"+t,{params:this.parameters}),this.meta.getFull(this.parameters.fields,this.parameters.layout)])];case 2:return e=o.sent(),r=e[0],n=e[1],(i=r.data).meta=n,[2,i]}})})},t.prototype.edit=function(t){return u(this,void 0,void 0,function(){var e,r,n,i,o,u;return c(this,function(c){switch(c.label){case 0:return[4,this.initialized];case 1:return c.sent(),e="RecordEdit",delete(r=s({},this.parameters,{layout:e})).fields,[4,Promise.all([this.http.get(this.endpoint+"/"+t,{params:r}),this.meta.getFull(this.parameters.fields,e)])];case 2:return n=c.sent(),i=n[0],o=n[1],(u=i.data).meta=o,[2,u]}})})},t.prototype.many=function(t,e,r,n){return void 0===n&&(n={}),u(this,void 0,void 0,function(){return c(this,function(i){switch(i.label){case 0:return[4,this.initialized];case 1:return i.sent(),[4,this.http.get(this.endpoint+"/"+r.id+"/"+t,{params:s({fields:e,showTotalMatched:!0},n)})];case 2:return[2,i.sent().data]}})})},t.prototype.save=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),t&&t.id?[2,this.http.post(this.endpoint+"/"+t.id,t)]:[2,this.http.put(this.endpoint,t)]}})})},t.prototype.delete=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[2,this.http.delete(""+this.endpoint+t)]}})})},t}(),he=function(){function t(t,e){void 0===e&&(e=[]),this.subscriptionId=t,this.types=e,this.subscriptionType="entity",this.eventTypes=["INSERTED","UPDATED","DELETED"],this.broker=It.getInstance(),this._lastRequestId=0,this._setUpObservable().catch(function(){return console.error("Error in Subscription")}),this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return t=this,[4,ue.http()];case 1:return t.http=e.sent(),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return"event/subscription/"+this.subscriptionId},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),[4,this.http.put(this.endpoint,{params:{type:this.subscriptionType,eventTypes:this.eventTypes,names:this.types}})];case 2:return[2,t.sent().data]}})})},t.prototype.unsubscribe=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),[4,this.http.delete(this.endpoint)];case 2:return[2,t.sent().data]}})})},t.prototype.get=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[4,this.http.get(this.endpoint,{params:{maxEvents:100}})];case 2:return t=e.sent(),this._lastRequestId=t.data.requestId,[2,t.data.events]}})})},t.prototype._setUpObservable=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){switch(e.label){case 0:return[4,this.unsubscribe()];case 1:return e.sent(),[4,this.subscribe()];case 2:return e.sent(),setInterval(function(){return u(t,void 0,void 0,function(){var t,e,r,n;return c(this,function(i){switch(i.label){case 0:return[4,this.get()];case 1:for(t=i.sent(),e=0,r=t;e<r.length;e++)n=r[e],this.broker.emit(n.entityName+":"+n.entityId+":invalidate",n);return[2]}})})},5e3),[2]}})})},t}(),le=function(){function t(){throw new TypeError("Cannot invoke the constructor function of a static class.")}return t.toSearchSyntax=function(e){for(var r=[],n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],s=e[o];"or"===o?r.push("("+t.toSearchSyntax(s).replace(/ AND /g," OR ")+")"):r.push(t.parseSearchValue(o,s))}return r.join(" AND ")},t.parseSearchValue=function(e,r){var n=[];if(Array.isArray(r))n.push(e+":"+t.writeLuceneValues(r));else if(r instanceof Object){if((r.min||r.max)&&n.push(e+":["+t.writeLuceneValue(r.min||"*")+" TO "+t.writeLuceneValue(r.max||"*")+"]"),r.any&&Array.isArray(r.any)){var i=r.any.map(function(t){return~(""+t).trim().indexOf(" ")?'"'+t+'"':t});n.push(e+":("+i.join(" ")+")")}if(r.all&&Array.isArray(r.all)){i=r.all.map(function(t){return~(""+t).trim().indexOf(" ")?'"'+t+'"':t});n.push(e+":("+i.join(" AND ")+")")}if(r.not&&n.push("NOT ("+t.parseSearchValue(e,r.not)+")"),r.like&&n.push(e+":("+r.like+"*)"),r.lookup&&n.push(e+':"^('+t.toQuerySyntax(r.lookup)+')"'),r.with&&n.push(e+'.id:"[0 TO *]"'),r.without&&n.push("-"+e+'.id:"[0 TO *]"'),r.or){var o={};o[e]=r.or,n.push(("("+t.toSearchSyntax(o)+")").replace(" AND "," OR "))}null!==r.memberOf&&void 0!==r.memberOf&&Array.isArray(r.memberOf)&&n.push(e+".id: ("+r.memberOf.join(" ")+")");for(var s=0,u=Object.keys(r);s<u.length;s++){var c=u[s];if(["min","max","any","all","not","or","like","lookup","with","without","isNull","memberOf"].indexOf(c)<0){var a=r[c];n.push(t.parseSearchValue(e+"."+c,a))}}}else r.indexOf&&~r.indexOf("*")?n.push(e+":("+r+")"):n.push(e+":"+t.writeLuceneValue(r));return n.join(" AND ")},t.writeLuceneValue=function(t){return t instanceof Date?t.toISOString().split(".")[0].replace(/[-:T]/gi,""):"number"==typeof t||"boolean"==typeof t?""+t:"*"===t?""+t:'"'+t+'"'},t.writeLuceneValues=function(t){return"number"==typeof t[0]||"boolean"==typeof t[0]?"("+t.join(" ")+")":'("'+t.join('" "')+'")'},t.toQuerySyntax=function(e){for(var r=[],n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],s=e[o];"or"===o?r.push("("+t.toQuerySyntax(s).replace(/ AND /g," OR ")+")"):r.push(t.parseQueryValue(o,s))}return r.join(" AND ")},t.parseQueryValue=function(e,r,n){void 0===n&&(n=!1);var i=[],o=n?" NOT IN ":" IN ",s=n?"<>":"=",u=n?"<":">=",c=n?">=":"<";if(Array.isArray(r))i.push(""+e+o+"("+t.writeQueryValues(r)+")");else if(r instanceof Object){if("boolean"==typeof r.isNull){var a=r.isNull?"IS NULL":"IS NOT NULL";i.push(e+" "+a)}var h;if(null!==r.min&&void 0!==r.min&&i.push(""+e+u+t.writeQueryValue(r.min)),null!==r.max&&void 0!==r.max&&i.push(""+e+c+t.writeQueryValue(r.max)),r.any&&Array.isArray(r.any)&&i.push(""+e+o+"("+t.writeQueryValues(r.any)+")"),r.all&&Array.isArray(r.all)&&i.push(""+e+o+"("+t.writeQueryValues(r.all)+")"),null!==r.not&&void 0!==r.not&&i.push(t.parseQueryValue(e,r.not,!0)),null!==r.like&&void 0!==r.like&&i.push(e+" like '%"+r.like+"%'"),null!==r.lookup&&void 0!==r.lookup)(h={})[e]=r.lookup,i.push(t.toQuerySyntax(h));if(null!==r.with&&void 0!==r.with&&i.push(e+" IS NOT EMPTY"),null!==r.without&&void 0!==r.without&&i.push(e+" IS EMPTY"),null!==r.or&&void 0!==r.or)(h={})[e]=r.or,i.push(t.toQuerySyntax(h).replace("AND","OR"));if(null!==r.memberOf&&void 0!==r.memberOf&&Array.isArray(r.memberOf)){for(var l=[],f=0,p=r.memberOf;f<p.length;f++){var d=p[f];n?l.push(d+" NOT MEMBER OF "+e):l.push(d+" MEMBER OF "+e)}n?i.push("("+l.join(" AND ")+")"):i.push("("+l.join(" OR ")+")")}for(var b=0,y=Object.keys(r);b<y.length;b++){var v=y[b];if(["min","max","any","all","not","or","like","lookup","with","without","isNull","memberOf"].indexOf(v)<0){var m=r[v];i.push(t.parseQueryValue(e+"."+v,m))}}}else i.push(""+e+s+t.writeQueryValue(r));return i.join(" AND ")},t.writeQueryValue=function(t){return t instanceof Date?t.getTime():"number"==typeof t||"boolean"==typeof t?""+t:"'"+t.replace(/\*/g,"")+"'"},t.writeQueryValues=function(t){return"number"==typeof t[0]||"boolean"==typeof t[0]?""+t.join(","):"'"+t.join("','")+"'"},t}(),fe=function(){function t(t){this.entity=t,this.records=[],this.parameters={fields:["id"],orderBy:["-dateAdded"],start:0,count:10},this._page=0,this.initialized=this.initialize(),this.meta=new ce(t)}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return t=this,[4,ue.http()];case 1:return t.http=e.sent(),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return this._endpoint||"query/"+this.entity},set:function(t){this._endpoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"total",{get:function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this._lastResponse&&this._lastResponse.total?[2,Promise.resolve(this._lastResponse.total)]:[2,this.http.get(this.endpoint,{params:s({fields:"id",count:0},this.parameters)}).then(function(t){return t.data}).then(function(t){return t.total||0})]}})})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapshot",{get:function(){return this._lastResponse},enumerable:!0,configurable:!0}),t.prototype.fields=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.parameters.fields=t[0]instanceof Array?t[0]:t,this},t.prototype.sort=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.parameters.orderBy=t[0]instanceof Array?t[0]:t,this},t.prototype.where=function(t){return this.query(le.toQuerySyntax(t))},t.prototype.query=function(t){return this.parameters.where=t,this},t.prototype.count=function(t){return this.parameters.count=t,this},t.prototype.page=function(t){return this._page=t,this.parameters.start=this.parameters.count*t,this},t.prototype.nextpage=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return[2,this.page(++this._page).run(!0)]})})},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,this.run(t)]})})},t.prototype.run=function(t){return u(this,void 0,void 0,function(){var e=this;return c(this,function(r){switch(r.label){case 0:return[4,this.initialized];case 1:return r.sent(),[2,Promise.all([this.http.get(this.endpoint,{params:this.parameters}),this.meta.getFull(this.parameters.fields,this.parameters.layout)]).then(function(t){var e=t[0],r=t[1];return[e.data,r]}).then(function(r){var n=r[0],i=r[1];e._lastResponse=n;var o=n.data;return e.records=t?e.records.concat(o):o,n.meta=i,n})]}})})},t.prototype.then=function(t,e){return u(this,void 0,void 0,function(){return c(this,function(r){return[2,this.run(!1).then(t,e)]})})},t}(),pe=function(){function t(t){this.optionType=t,this.records=[],this.parameters={filter:void 0,start:0,count:10},this._page=0,this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return t=this,[4,ue.http()];case 1:return t.http=e.sent(),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return this._endpoint||"options/"+this.optionType},set:function(t){this._endpoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapshot",{get:function(){return this._lastResponse},enumerable:!0,configurable:!0}),t.prototype.filter=function(t){return this.parameters.filter=t,this},t.prototype.count=function(t){return this.parameters.count=t,this},t.prototype.page=function(t){return this._page=t,this.parameters.start=this.parameters.count*t,this},t.prototype.nextpage=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return[2,this.page(++this._page).run(!0)]})})},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,this.run(t)]})})},t.prototype.run=function(t){return u(this,void 0,void 0,function(){var e=this;return c(this,function(r){switch(r.label){case 0:return[4,this.initialized];case 1:return r.sent(),[2,this.http.get(this.endpoint,{params:this.parameters}).then(function(t){return t.data}).then(function(r){e._lastResponse=r;var n=r.data;return e.records=t?e.records.concat(n):n,r}).catch(function(t){return t})]}})})},t.prototype.then=function(t,e){return u(this,void 0,void 0,function(){return c(this,function(r){return[2,this.run(!1).then(t,e)]})})},t}(),de=function(){function t(t,e){void 0===e&&(e={}),this.types=t,this.options=e,this.records=[],this.parameters={entity:[],filter:void 0,count:10,isCountPerEntity:!0},this.initialized=this.initialize(),this.params(s({entity:this.types},this.options))}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return t=this,[4,ue.http()];case 1:return t.http=e.sent(),[2]}})})},Object.defineProperty(t.prototype,"endpoint",{get:function(){return this._endpoint||"lookup/expanded"},set:function(t){this._endpoint=t},enumerable:!0,configurable:!0}),t.prototype.filter=function(t){return this.parameters.filter=t,this},t.prototype.count=function(t){return this.parameters.count=t,this},t.prototype.params=function(t){return this.parameters=s({},this.parameters,t),this},t.prototype.get=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return[2,this.run()]})})},t.prototype.run=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[2,this.http.get(this.endpoint,{params:this.parameters}).then(function(t){return t.data}).then(function(e){return t.records=e,e}).catch(function(t){return t})]}})})},t.prototype.then=function(t,e){return u(this,void 0,void 0,function(){return c(this,function(r){return[2,this.run().then(t,e)]})})},t}(),be=function(t){function e(e){var r=t.call(this,e)||this;return r.parameters={fields:["id"],sort:["-dateAdded"],start:0,count:10},r}return o(e,t),Object.defineProperty(e.prototype,"endpoint",{get:function(){return this._endpoint||"search/"+this.entity},set:function(t){this._endpoint=t},enumerable:!0,configurable:!0}),e.prototype.sort=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.parameters.sort=t[0]instanceof Array?t[0]:t,this},e.prototype.where=function(t){return this.query(le.toSearchSyntax(t))},e.prototype.query=function(t){return this.parameters.query=t,this},e.prototype.then=function(t,e){return u(this,void 0,void 0,function(){return c(this,function(r){return[2,this.run(!1).then(t,e)]})})},e}(fe),ye=function(){function t(){this.allSettingsAndEntitlementsEndpoint="services/Settings/allEntitlementsAndSettings",this.initialized=this.initialize()}return t.prototype.initialize=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return t=this,[4,ue.http()];case 1:return t.http=e.sent(),[2]}})})},t.prototype.getSettings=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[4,this.http.get("settings/"+t.join())];case 2:return[2,e.sent().data]}})})},t.prototype.getEntitlements=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,this.initialized];case 1:return e.sent(),[4,this.http.get("entitlements/"+t)];case 2:return[2,e.sent().data]}})})},t.prototype.getAllSettingsAndEntitlements=function(t){return void 0===t&&(t=!1),u(this,void 0,void 0,function(){var e,r,n;return c(this,function(i){switch(i.label){case 0:return[4,this.initialized];case 1:return i.sent(),(r=t)?[4,ie.has(this.allSettingsAndEntitlementsEndpoint)]:[3,3];case 2:r=i.sent(),i.label=3;case 3:return r?[4,ie.get(this.allSettingsAndEntitlementsEndpoint)]:[3,5];case 4:return e=i.sent(),[3,7];case 5:return[4,this.http.get(this.allSettingsAndEntitlementsEndpoint)];case 6:n=i.sent(),e=n.data,t&&ie.put(this.allSettingsAndEntitlementsEndpoint,e),i.label=7;case 7:return e&&e.dashboardEntitlements&&e.entitlements&&(e.entitlements.Dashboard=e.dashboardEntitlements),[2,e]}})})},t}(),ve=function(){function t(){}return t.prototype.validateCode=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,r.post(this.config.token_url+"?grant_type=authorization_code&code="+t+"&client_id="+this.config.client_id+"&client_secret="+this.config.client_secret).then(function(t){return t.data})]})})},t.prototype.restLogin=function(t){return u(this,void 0,void 0,function(){var e;return c(this,function(n){return e=this.config.ttl?"&ttl="+this.config.ttl:"",[2,r.post(this.config.login_url+"?version=*&access_token="+t+e).then(function(t){return t.data})]})})},t}(),me=function(){function t(t,e){this.username=t,this.password=e}return t.prototype.credential=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,r.get(t.login_url+"?version=*&username="+this.username+"&password="+this.password+"&clientId="+t.client_id).then(function(t){return t.data})]})})},t}(),ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.credential=function(t){return u(this,void 0,void 0,function(){var e,r;return c(this,function(n){switch(n.label){case 0:return this.config=t,[4,this.getAuthCode()];case 1:return e=n.sent(),[4,this.validateCode(e)];case 2:return r=n.sent(),[2,this.restLogin(r.access_token)]}})})},e.prototype.getAuthCode=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r.get(""+this.config.authorization_url,{params:{client_id:this.config.client_id,response_type:"code",action:"Login",username:this.config.username,password:this.config.password}})];case 1:return[2,e.sent().request.path.split("?code=").pop().split("&").shift()];case 2:throw t=e.sent(),console.warn("Error retrieving AuthCode",t.message),t;case 3:return[2]}})})},e}(ve),_e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.credential=function(t){return u(this,void 0,void 0,function(){var e,r,n;return c(this,function(i){return this.config=t,e="location=0,status=0,width=800,height=600",r=t.authorization_url+"?response_type=code&clientId="+t.client_id+"&redirect_uri="+t.redirect_url,n=window.open(r,"bhAuthWindow",e),[2,this.getAuthCode(n).then(this.validateCode).then(this.restLogin)]})})},e.prototype.getAuthCode=function(t){return u(this,void 0,void 0,function(){var e=this;return c(this,function(r){return[2,Promise.resolve().then(function(){var r=window.setInterval(function(){try{if(-1!==t.document.URL.indexOf(e.config.redirect_url)){window.clearInterval(r);var n=se.destruct(t.document.URL);return t.close(),n.params.access_token}}catch(t){console.warn("Error retrieving AuthCode",t.message)}},1e3)})]})})},e}(ve),we=Symbol("EMPTY"),Se=function(t){function r(e){void 0===e&&(e=we);var r=t.call(this)||this;return r._value=e,r}return o(r,t),Object.defineProperty(r.prototype,"snapshot",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&this.hasValue()&&e.next(this._value),r},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new e.ObjectUnsubscribedError;return this._value},r.prototype.hasValue=function(){return!this.hasError&&(!this.closed&&this._value!==we)},r.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},r.prototype.once=function(){return this.pipe((t=1,function(e){return 0===t?et():e.lift(new pt(t))}));var t},r}(e.Subject),Oe="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ee(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function xe(t,e){return t(e={exports:{}},e.exports),e.exports}var je=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isFunction=function(t){return"function"==typeof t}});Ee(je);je.isFunction;var ke=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=!1;e.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){var e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=t},get useDeprecatedSynchronousErrorHandling(){return r}}});Ee(ke);ke.config;var Pe=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.hostReportError=function(t){setTimeout(function(){throw t})}});Ee(Pe);Pe.hostReportError;var Te=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.empty={closed:!0,next:function(t){},error:function(t){if(ke.config.useDeprecatedSynchronousErrorHandling)throw t;Pe.hostReportError(t)},complete:function(){}}});Ee(Te);Te.empty;var Ae=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}});Ee(Ae);Ae.isArray;var Ie=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isObject=function(t){return null!=t&&"object"==typeof t}});Ee(Ie);Ie.isObject;var Ce=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.errorObject={e:{}}});Ee(Ce);Ce.errorObject;var De=xe(function(t,e){var r;function n(){try{return r.apply(this,arguments)}catch(t){return Ce.errorObject.e=t,Ce.errorObject}}Object.defineProperty(e,"__esModule",{value:!0}),e.tryCatch=function(t){return r=t,n}});Ee(De);De.tryCatch;var Ne=xe(function(t,e){function r(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}Object.defineProperty(e,"__esModule",{value:!0}),r.prototype=Object.create(Error.prototype),e.UnsubscriptionError=r});Ee(Ne);Ne.UnsubscriptionError;var Re=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,i=this._parents,o=this._unsubscribe,s=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var u=-1,c=i?i.length:0;r;)r.remove(this),r=++u<c&&i[u]||null;if(je.isFunction(o))De.tryCatch(o).call(this)===Ce.errorObject&&(e=!0,t=t||(Ce.errorObject.e instanceof Ne.UnsubscriptionError?n(Ce.errorObject.e.errors):[Ce.errorObject.e]));if(Ae.isArray(s))for(u=-1,c=s.length;++u<c;){var a=s[u];if(Ie.isObject(a))if(De.tryCatch(a.unsubscribe).call(a)===Ce.errorObject){e=!0,t=t||[];var h=Ce.errorObject.e;h instanceof Ne.UnsubscriptionError?t=t.concat(n(h.errors)):t.push(h)}}if(e)throw new Ne.UnsubscriptionError(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();function n(t){return t.reduce(function(t,e){return t.concat(e instanceof Ne.UnsubscriptionError?e.errors:e)},[])}e.Subscription=r});Ee(Re);Re.Subscription;var Le=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.rxSubscriber="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),e.$$rxSubscriber=e.rxSubscriber});Ee(Le);Le.rxSubscriber,Le.$$rxSubscriber;var Me=xe(function(t,e){var r,n=Oe&&Oe.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(r,n,i){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,s._parentSubscription=null,arguments.length){case 0:s.destination=Te.empty;break;case 1:if(!r){s.destination=Te.empty;break}if("object"==typeof r){r instanceof e?(s.syncErrorThrowable=r.syncErrorThrowable,s.destination=r,r.add(s)):(s.syncErrorThrowable=!0,s.destination=new o(s,r));break}default:s.syncErrorThrowable=!0,s.destination=new o(s,r,n,i)}return s}return n(e,t),e.prototype[Le.rxSubscriber]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},e}(Re.Subscription);e.Subscriber=i;var o=function(t){function e(e,r,n,i){var o,s=t.call(this)||this;s._parentSubscriber=e;var u=s;return je.isFunction(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==Te.empty&&(u=Object.create(r),je.isFunction(u.unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(s))),s._context=u,s._next=o,s._error=n,s._complete=i,s}return n(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;ke.config.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=ke.config.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):Pe.hostReportError(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;Pe.hostReportError(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};ke.config.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),ke.config.useDeprecatedSynchronousErrorHandling)throw t;Pe.hostReportError(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!ke.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return ke.config.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(Pe.hostReportError(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(i);e.SafeSubscriber=o});Ee(Me);Me.Subscriber,Me.SafeSubscriber;var ze=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.canReportError=function(t){for(;t;){var e=t,r=e.closed,n=e.destination,i=e.isStopped;if(r||i)return!1;t=n&&n instanceof Me.Subscriber?n:null}return!0}});Ee(ze);ze.canReportError;var Ue=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.toSubscriber=function(t,e,r){if(t){if(t instanceof Me.Subscriber)return t;if(t[Le.rxSubscriber])return t[Le.rxSubscriber]()}return t||e||r?new Me.Subscriber(t,e,r):new Me.Subscriber(Te.empty)}});Ee(Ue);Ue.toSubscriber;var Ve=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.observable="function"==typeof Symbol&&Symbol.observable||"@@observable"});Ee(Ve);Ve.observable;var Be=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.noop=function(){}});Ee(Be);Be.noop;var Fe=xe(function(t,e){function r(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:Be.noop}Object.defineProperty(e,"__esModule",{value:!0}),e.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(t)},e.pipeFromArray=r});Ee(Fe);Fe.pipe,Fe.pipeFromArray;var $e=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=Ue.toSubscriber(t,e,r);if(n?n.call(i,this.source):i.add(this.source||ke.config.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),ke.config.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){ke.config.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),ze.canReportError(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=n(e))(function(e,n){var i;i=r.subscribe(function(e){try{t(e)}catch(t){n(t),i&&i.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[Ve.observable]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:Fe.pipeFromArray(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=n(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function n(t){if(t||(t=ke.config.Promise||Promise),!t)throw new Error("no Promise impl found");return t}e.Observable=r});Ee($e);$e.Observable;var He=xe(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isObservable=function(t){return!!t&&(t instanceof $e.Observable||"function"==typeof t.lift&&"function"==typeof t.subscribe)}});Ee(He);var Ye=He.isObservable;function Qe(t,r){return void 0===r&&(r=!0),Rt(t).defined?e.Observable.create(function(n){var i=e.combineLatest(qe("id",t),qe("fields",t),qe("layout",t),qe("meta",t),qe("showEditable",t),qe("showReadOnly",t),qe("executeFormTriggers",t),qe("params",t));r&&(i=i.pipe(G(0))),i.subscribe(function(t){var e=t[0],r=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],a=t[7],h={};void 0!==e&&(h.id=e),void 0!==r&&(h.fields=r),void 0!==i&&(h.layout=i),void 0!==o&&(h.meta=o),void 0!==s&&(h.showEditable=s),void 0!==u&&(h.showReadOnly=u),void 0!==c&&(h.executeFormTriggers=c),void 0!==a&&(h.params=a),n.next(h)})}):e.of(null)}function qe(t,r){return Ye(r[t])?r[t]:Dt(r).have(t)?new e.Observable(function(e){e.next(r[t])}):new e.Observable(function(t){t.next(void 0)})}var Je=function(t){function e(e,r,n){void 0===r&&(r={});var i=t.call(this,n)||this;return i._fields=[],i.broker=It.getInstance(),i.type=e,i.$entity=new ae(i.type),Qe(r).subscribe(function(t){if(t)for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e];switch(n){case"fields":i.fields(t.fields);break;case"layout":i.$entity.params({layout:t.layout});break;case"meta":i.$entity.meta.style(t.meta);break;case"showEditable":i.$entity.params({showEditable:t.showEditable});break;case"showReadOnly":i.$entity.params({showReadOnly:t.showReadOnly});break;case"executeFormTriggers":i.$entity.params({executeFormTriggers:t.executeFormTriggers});break;case"params":i.$entity.params(t.params);break;case"id":i.get(t.id);break;default:console.warn("Unknown key in params: "+n)}}}),i.hasValue()&&(i.fields(Object.keys(i.value)),i._setUpObservable(i.value)),i}return o(e,t),e.prototype.fields=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=0,i=Array.isArray(e[0])?e[0]:e;n<i.length;n++){var o=i[n];this._fields.includes(o)||(this._proxy(o),this._fields.push(o))}return(t=this.$entity).fields.apply(t,e),this},e.prototype._proxy=function(t){var e=new Se(this.value&&this.value[t]);Object.defineProperty(this,t,{get:function(){return e},set:function(r){var n;this.patch(((n={})[t]=r,n)),e.next(r)},configurable:!0,enumerable:!0})},e.prototype.params=function(t){return t.hasOwnProperty("fields")&&(this.fields(t.fields),delete t.fields),this.$entity.params(t),this},e.prototype.set=function(t){return this.next(t),this.fields(Object.keys(t)),this.broker.emit(this.type+":"+t.id+":value",t),this},e.prototype.patch=function(t,e){void 0===e&&(e=!1);var r=this.value||{},n=s({},r,t);return this.next(n),this.fields(Object.keys(n)),e||this.broker.emit(this.type+":"+n.id+":value",n),this},e.prototype.get=function(t){var e=this;return this.$entity.get(t).then(function(t){return e.descriptor=t.meta,e.patch(t.data),e._setUpObservable(e.getValue()),t}),this},e.prototype.many=function(t,e){var r=this;return this.$entity.many(t,e,this.value).then(function(e){return r._fields.includes(t)||(r._proxy(t),r._fields.push(t)),r.value[t]=e,r.patch({property:e}),r._setUpObservable(r.getValue()),e}),this},e.prototype.save=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){return[2,this.$entity.save(this.value).then(function(e){var r=e.data;return t.patch({id:r.changedEntityId}),t._setUpObservable(t.getValue()),e})]})})},e.prototype.remove=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return[2,this.$entity.delete(this.value.id)]})})},e.prototype._setUpObservable=function(t){var e=this;t&&t.id&&this.broker.on(this.type+":"+t.id+":value").subscribe(function(t){e.patch(t,!0)})},e}(Se);function We(t,r){return void 0===r&&(r=!0),Rt(t).defined?e.Observable.create(function(n){var i=e.combineLatest(qe("fields",t),qe("layout",t),qe("meta",t),qe("orderBy",t),qe("startAt",t),qe("limitTo",t),qe("filter",t),qe("params",t));r&&(i=i.pipe(G(0))),i.subscribe(function(t){var e=t[0],r=t[1],i=t[2],o=t[3],s=t[4],u=t[5],c=t[6],a=t[7],h={};void 0!==e&&(h.fields=e),void 0!==r&&(h.layout=r),void 0!==i&&(h.meta=i),void 0!==o&&(h.orderBy=o),void 0!==s&&(h.startAt=s),void 0!==u&&(h.limitTo=u),void 0!==c&&(h.filter=c),void 0!==a&&(h.params=a),n.next(h)})}):e.of(null)}var Ke=function(t){function e(e,r,n){void 0===r&&(r={});var i=t.call(this,n)||this;return i.broker=It.getInstance(),i.type=e,i.$ref=new Je(i.type,{}),i.$list=i.getSearcher(i.type),We(r).subscribe(function(t){if(t)for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e];switch(n){case"fields":i.$list.fields(t.fields);break;case"layout":i.$list.params({layout:t.layout});break;case"meta":i.$list.meta.style(t.meta);break;case"orderBy":i.$list.sort(t.orderBy);break;case"startAt":i.$list.params({start:t.startAt});break;case"limitTo":i.$list.count(t.limitTo||25);break;case"filter":i.$list.where(t.filter);break;case"params":i.$list.params(t.params);break;default:console.warn("Unknown key in params: "+n)}}i.$list.then(function(t){i.descriptor=t.meta,i.$latest=t,i.next(t.data)},function(t){i.error(t)})}),i._setUpObservable(),i}return o(e,t),e.prototype.getSearcher=function(t){return["Candidate","ClientContact","ClientCorporation","JobOrder","Lead","Opportunity","Placement","JobSubmission","Note","UserMessage"].indexOf(t)>=0?new be(this.type):new fe(this.type)},Object.defineProperty(e.prototype,"lastAdded",{get:function(){return this.$ref},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"info",{get:function(){return{total:this.$latest.total,messages:this.$latest.messages,start:this.$latest.start,count:this.$latest.count}},enumerable:!0,configurable:!0}),e.prototype.findById=function(t){var e=this.getValue().find(function(e){return e.id===t});return e||new Je(this.type,{id:t})},e.prototype.push=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,this.$ref.set(t).save().then(this._eventHook("child_added"))]})})},e.prototype.update=function(t,e){return u(this,void 0,void 0,function(){var r=this;return c(this,function(n){return[2,this._checkOperationCases(t,{keyCase:function(){return u(r,void 0,void 0,function(){return c(this,function(r){return[2,this.findById(t).patch(e).save()]})})},entityCase:function(){return u(r,void 0,void 0,function(){return c(this,function(r){return[2,t.patch(e).save()]})})}}).then(this._eventHook("child_updated"))]})})},e.prototype.remove=function(t){return u(this,void 0,void 0,function(){var e=this;return c(this,function(r){return[2,this._checkOperationCases(t,{keyCase:function(){return u(e,void 0,void 0,function(){return c(this,function(e){return[2,this.findById(t).remove()]})})},entityCase:function(){return u(e,void 0,void 0,function(){return c(this,function(e){return[2,t.remove()]})})}}).then(this._eventHook("child_removed"))]})})},e.prototype._setUpObservable=function(){var t=this;this.broker.on(this.type+":*").subscribe(function(){t.$list.then(function(e){t.descriptor=e.meta,t.next(e.data)})})},e.prototype._eventHook=function(t){var e=this;return function(r){return e.broker.emit(e.type+":"+r.changedEntityId+":value",r.data),e.broker.emit(e.type+":"+t,r.data),r}},e.prototype._checkOperationCases=function(t,e){return u(this,void 0,void 0,function(){return c(this,function(r){if(Rt(t).aNumber)return[2,e.keyCase()];if(Rt(t).aTypeOf(Je))return[2,e.entityCase()];throw new Error("Method requires a key or reference. Got: "+typeof t)})})},e.useSearch=!1,e}(Se);t.EntityMessageBroker=It,t.EntityService=ae,t.EntitySubscription=he,t.MetaService=ce,t.QueryService=fe,t.OptionsService=pe,t.LookupService=de,t.SearchService=be,t.SettingService=ye,t.Staffing=ue,t.StaffingOAuthBaseProvider=ve,t.StaffingCredentialsAuthProvider=me,t.StaffingOAuthProvider=ge,t.StaffingOAuthPopupProvider=_e,t.Where=le,t.Can=Ct,t.can=Dt,t.Is=Nt,t.is=Rt,t.Cache=ie,t.Deferred=function(){var t={},e=new Promise(function(e,r){t.resolve=e,t.reject=r});return e.resolve=t.resolve,e.reject=t.reject,e},t.Lazy=oe,t.Memory=Lt,t.QueryString=se,t.Browser=Mt,t.Entity=Je,t.observeOptions=Qe,t.getOrCreateObservable=qe,t.EntityList=Ke,t.observeListOptions=We,t.EMPTY=we,t.StatefulSubject=Se,Object.defineProperty(t,"__esModule",{value:!0})});
